<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>شجرة المجالات الهندسية</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body class="p-4">

  <h2 class="mb-3 text-primary text-center">شجرة المجالات الهندسية</h2>

  <div class="row mb-3">
    <div class="col-md-3">
      <label>المجال الرئيسي</label>
      <select id="mainField" class="form-select">
        <option value="">اختر المجال</option>
      </select>
    </div>
    <div class="col-md-3">
      <label>التخصص</label>
      <select id="specialty" class="form-select">
        <option value="">اختر التخصص</option>
      </select>
    </div>
    <div class="col-md-3">
      <label>الفرع الرئيسي</label>
      <select id="branch" class="form-select">
        <option value="">اختر الفرع</option>
      </select>
    </div>
    <div class="col-md-3">
      <label>التفصيل</label>
      <select id="detail" class="form-select">
        <option value="">اختر التفصيل</option>
      </select>
    </div>
  </div>

  <script>
    // ✅ البيانات الكاملة كما في الجدول
    const data = [
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "المساحة", detail: "رفع مساحي للمشاريع الهندسية" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "المساحة", detail: "مسح التصرفات (بيع، شراء، تأجير)" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "المساحة", detail: "قضايا النزاع" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "المساحة", detail: "تقسيم بين الورثة" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "المساحة", detail: "شبكات التثليث" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الإنشاءات", detail: "التصميم الإنشائي" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الإنشاءات", detail: "الإشراف" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الإنشاءات", detail: "التنفيذ" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الإنشاءات", detail: "فحص واختبار المواد" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الإنشاءات", detail: "الصيانة والترميم" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الإنشاءات", detail: "تثمين العقارات" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الطرق والمواصلات", detail: "تخطيط النقل وهندسة المرور" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الطرق والمواصلات", detail: "إنشاء وتنفيذ الطرق" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "الطرق والمواصلات", detail: "صيانة الرصف" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "ميكانيكا التربة", detail: "استكشاف الموقع واختبارات التربة" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "ميكانيكا التربة", detail: "تحليل استقرار المنحدرات" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "ميكانيكا التربة", detail: "تحسين خواص التربة" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة الموارد المائية", detail: "تصميم وتشييد السدود" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة الموارد المائية", detail: "تصميم شبكات المياه والصرف الصحي" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة الموارد المائية", detail: "تحلية المياه" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة الموارد المائية", detail: "الهيدرولوجيا (دراسة دورات المياه)" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة الموارد المائية", detail: "معالجة المياه والصرف الصحي" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة الموارد المائية", detail: "التقييم البيئي للمشاريع" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة وإدارة التشييد", detail: "تخطيط وجدولة المشاريع" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة وإدارة التشييد", detail: "تقدير التكاليف وضبط الميزانية" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة وإدارة التشييد", detail: "إدارة العقود والمشتريات" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة وإدارة التشييد", detail: "إدارة السلامة والصحة المهنية" },
      { main: "المجال الهندسي", spec: "الهندسة المدنية", branch: "هندسة وإدارة التشييد", detail: "إدارة الجودة في التشييد" },
      { main: "المجال الهندسي", spec: "الهندسة المعمارية", branch: "تصميم المباني", detail: "تصميم مباني سكنية" },
      { main: "المجال الهندسي", spec: "الهندسة المعمارية", branch: "تصميم المباني", detail: "تصميم مباني مؤسسية (مستشفيات، مدارس)" },
      { main: "المجال الهندسي", spec: "الهندسة المعمارية", branch: "تصميم المباني", detail: "تصميم مباني ثقافية وتجارية" },
      { main: "المجال الهندسي", spec: "الهندسة المعمارية", branch: "التصميم الداخلي والديكور", detail: "" }
    ];

    // استخراج القيم الفريدة لكل مستوى
    const unique = (arr, key) => [...new Set(arr.map(x => x[key]))];

    // تعبئة القائمة الأولى
    function fillMain() {
      const mains = unique(data, "main");
      $("#mainField").append(mains.map(m => `<option value="${m}">${m}</option>`));
    }

    // عند اختيار المجال الرئيسي
    $("#mainField").on("change", function () {
      const selected = $(this).val();
      const specs = unique(data.filter(x => x.main === selected), "spec");
      fillSelect($("#specialty"), specs, "اختر التخصص");
      clearNext(["#branch", "#detail"]);
    });

    // عند اختيار التخصص
    $("#specialty").on("change", function () {
      const selectedMain = $("#mainField").val();
      const selectedSpec = $(this).val();
      const branches = unique(data.filter(x => x.main === selectedMain && x.spec === selectedSpec), "branch");
      fillSelect($("#branch"), branches, "اختر الفرع");
      clearNext(["#detail"]);
    });

    // عند اختيار الفرع
    $("#branch").on("change", function () {
      const selectedMain = $("#mainField").val();
      const selectedSpec = $("#specialty").val();
      const selectedBranch = $(this).val();
      const details = unique(data.filter(x =>
        x.main === selectedMain && x.spec === selectedSpec && x.branch === selectedBranch
      ), "detail");
      fillSelect($("#detail"), details, "اختر التفصيل");
    });

    function fillSelect(select, list, placeholder) {
      select.empty().append(`<option value="">${placeholder}</option>`);
      list.forEach(i => select.append(`<option value="${i}">${i}</option>`));
    }

    function clearNext(ids) {
      ids.forEach(id => $(id).empty().append(`<option value="">---</option>`));
    }

    // تحميل القيم الأولية
    fillMain();
  </script>

</body>
</html>
